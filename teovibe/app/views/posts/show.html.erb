<article class="max-w-[800px] mx-auto px-5 py-10">
  <%= render "shared/breadcrumb", items: [
    { name: "홈", path: root_path },
    { name: @post.category_name, path: send("#{@post.category.pluralize}_path") },
    { name: @post.title }
  ] %>

  <header class="mb-8">
    <div class="mb-4">
      <%= render "shared/tag", text: @post.category_name %>
    </div>
    <h1 class="text-3xl md:text-display font-black leading-tight mb-4"><%= @post.title %></h1>
    <div class="flex items-center gap-4 text-tv-gray">
      <span class="font-medium"><%= @post.user.nickname %></span>
      <span><%= l(@post.created_at, format: :long) rescue @post.created_at.strftime("%Y년 %m월 %d일") %></span>
      <span>조회 <%= @post.views_count %></span>
    </div>
  </header>

  <div class="prose prose-lg max-w-none mb-10">
    <%= @post.body %>
  </div>

  <%# 좋아요 + 액션 %>
  <div class="flex items-center justify-between border-t border-b border-tv-cream py-4 mb-10">
    <div id="<%= dom_id(@post, :like) %>">
      <%= render "likes/button", likeable: @post %>
    </div>
    <% if @post.user == Current.user || Current.user&.admin? %>
      <div class="flex items-center gap-3">
        <%= link_to "수정", send("edit_#{@post.category}_path", @post), class: "text-sm text-tv-gray hover:text-tv-black" %>
        <%= button_to "삭제", send("#{@post.category}_path", @post), method: :delete,
          data: { turbo_confirm: "정말 삭제하시겠습니까?" },
          class: "text-sm text-red-500 hover:text-red-700" %>
      </div>
    <% end %>
  </div>

  <%# 댓글 섹션 %>
  <section id="comments">
    <h2 class="text-xl font-black mb-6">댓글 <span class="text-tv-gray font-normal"><%= @post.comments_count %></span></h2>

    <% if Current.user %>
      <%= render "comments/form", post: @post %>
    <% else %>
      <p class="text-tv-gray mb-6"><%= link_to "로그인", new_session_path, class: "text-tv-orange font-bold" %>하고 댓글을 남겨보세요.</p>
    <% end %>

    <div id="comments-list" class="space-y-6">
      <% @comments.each do |comment| %>
        <%= render "comments/comment", comment: comment %>
      <% end %>
    </div>
  </section>
</article>
